<!-- This file was generated by npm create vue -->
<template>
	<div id="app" :class="accessibilityClasses">
		<RouterView />
	</div>
</template>

<script setup>
	import { RouterView } from "vue-router";
	import { ref, computed, onMounted, watch } from "vue";

	const colorblindMode = ref(
		localStorage.getItem("colorblindMode") || "Default"
	);
	const enablePatterns = ref(localStorage.getItem("enablePatterns") === "true");
	const showLabels = ref(localStorage.getItem("showLabels") === "true");

	const accessibilityClasses = computed(() => {
		const classes = [];

		// Add colorblind class
		switch (colorblindMode.value) {
			case "Default":
				// No class needed for default mode
				break;
			case "Red-Blind (Protanopia)":
				classes.push("protanopia");
				break;
			case "Green-Blind (Deuteranopia)":
				classes.push("deuteranopia");
				break;
			case "Blue-Blind (Tritanopia)":
				classes.push("tritanopia");
				break;
			case "Grayscale (achromatopsia)":
				classes.push("achromatopsia");
				break;
			case "High Contrast":
				classes.push("high-contrast");
				break;
		}

		// Add additional classes
		if (enablePatterns.value) classes.push("enable-patterns");
		if (showLabels.value) classes.push("show-labels");

		return classes;
	});

	// Watch for changes in localStorage
	onMounted(() => {
		window.addEventListener("storage", (e) => {
			if (e.key === "colorblindMode") {
				colorblindMode.value = e.newValue;
			} else if (e.key === "enablePatterns") {
				enablePatterns.value = e.newValue === "true";
			} else if (e.key === "showLabels") {
				showLabels.value = e.newValue === "true";
			}
		});
	});
</script>

<style>
	@import "./assets/accessibility.css";
</style>
